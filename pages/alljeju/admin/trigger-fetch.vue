<template>
  <div>
    <h2 class="text-2xl font-semibold mb-6">ìˆ˜ë™ ë°ì´í„° ìˆ˜ì§‘ íŠ¸ë¦¬ê±°</h2>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
      <!-- ì¶•ì œ ë°ì´í„° ìˆ˜ì§‘ -->
      <div class="p-6 bg-white rounded-lg shadow">
        <h3 class="text-xl font-semibold mb-3">ì¶•ì œ ì •ë³´</h3>
        <p class="text-sm text-gray-600 mb-4">ì¶•ì œ ê´€ë ¨ ìµœì‹  ë°ì´í„°ë¥¼ ìˆ˜ë™ìœ¼ë¡œ ìˆ˜ì§‘í•©ë‹ˆë‹¤.</p>
        <button
          @click="triggerFetch('festivals')"
          :disabled="loading.festivals"
          class="w-full bg-purple-500 text-white px-4 py-2 rounded hover:bg-purple-600 disabled:bg-gray-400 flex items-center justify-center">
          <svg v-if="loading.festivals" class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
          </svg>
          {{ loading.festivals ? 'ìˆ˜ì§‘ ì¤‘...' : 'ì¶•ì œ ë°ì´í„° ìˆ˜ì§‘ ì‹¤í–‰' }}
        </button>
        <div v-if="results.festivals" class="mt-4 p-3 rounded-md text-sm"
             :class="results.festivals.success ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'">
          {{ results.festivals.message }}
        </div>
      </div>

      <!-- ì „ì‹œíšŒ ë°ì´í„° ìˆ˜ì§‘ -->
      <div class="p-6 bg-white rounded-lg shadow">
        <h3 class="text-xl font-semibold mb-3">ì „ì‹œíšŒ ì •ë³´</h3>
        <p class="text-sm text-gray-600 mb-4">ì „ì‹œíšŒ ê´€ë ¨ ìµœì‹  ë°ì´í„°ë¥¼ ìˆ˜ë™ìœ¼ë¡œ ìˆ˜ì§‘í•©ë‹ˆë‹¤.</p>
        <button
          @click="triggerFetch('exhibitions')"
          :disabled="loading.exhibitions"
          class="w-full bg-teal-500 text-white px-4 py-2 rounded hover:bg-teal-600 disabled:bg-gray-400 flex items-center justify-center">
          <svg v-if="loading.exhibitions" class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
          </svg>
          {{ loading.exhibitions ? 'ìˆ˜ì§‘ ì¤‘...' : 'ì „ì‹œíšŒ ë°ì´í„° ìˆ˜ì§‘ ì‹¤í–‰' }}
        </button>
        <div v-if="results.exhibitions" class="mt-4 p-3 rounded-md text-sm"
             :class="results.exhibitions.success ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'">
          {{ results.exhibitions.message }}
        </div>
      </div>

      <!-- ë³µì§€ ì„œë¹„ìŠ¤ ë°ì´í„° ìˆ˜ì§‘ -->
      <div class="p-6 bg-white rounded-lg shadow">
        <h3 class="text-xl font-semibold mb-3">ë³µì§€ ì„œë¹„ìŠ¤ ì •ë³´</h3>
        <p class="text-sm text-gray-600 mb-4">ë³µì§€ ì„œë¹„ìŠ¤ ê´€ë ¨ ìµœì‹  ë°ì´í„°ë¥¼ ìˆ˜ë™ìœ¼ë¡œ ìˆ˜ì§‘í•©ë‹ˆë‹¤.</p>
        <button
          @click="triggerFetch('welfare-services')"
          :disabled="loading.welfareServices"
          class="w-full bg-sky-500 text-white px-4 py-2 rounded hover:bg-sky-600 disabled:bg-gray-400 flex items-center justify-center">
           <svg v-if="loading.welfareServices" class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 714 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
          </svg>
          {{ loading.welfareServices ? 'ìˆ˜ì§‘ ì¤‘...' : 'ë³µì§€ ì„œë¹„ìŠ¤ ìˆ˜ì§‘ ì‹¤í–‰' }}
        </button>
        <div v-if="results.welfareServices" class="mt-4 p-3 rounded-md text-sm"
             :class="results.welfareServices.success ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'">
          {{ results.welfareServices.message }}
        </div>
      </div>

      <!-- ì£¼ìœ ì†Œ ë°ì´í„° ìˆ˜ì§‘ -->
      <div class="p-6 bg-white rounded-lg shadow">
        <h3 class="text-xl font-semibold mb-3">ì£¼ìœ ì†Œ ì •ë³´</h3>
        <p class="text-sm text-gray-600 mb-4">ì œì£¼ë„ ì£¼ìœ ì†Œ ë° ê°€ê²© ì •ë³´ë¥¼ ìˆ˜ë™ìœ¼ë¡œ ìˆ˜ì§‘í•©ë‹ˆë‹¤.</p>
        <button
          @click="triggerFetch('gas-stations')"
          :disabled="loading.gasStations"
          class="w-full bg-orange-500 text-white px-4 py-2 rounded hover:bg-orange-600 disabled:bg-gray-400 flex items-center justify-center">
           <svg v-if="loading.gasStations" class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 714 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
          </svg>
          {{ loading.gasStations ? 'ìˆ˜ì§‘ ì¤‘...' : 'ì£¼ìœ ì†Œ ì •ë³´ ìˆ˜ì§‘ ì‹¤í–‰' }}
        </button>
        <div v-if="results.gasStations" class="mt-4 p-3 rounded-md text-sm"
             :class="results.gasStations.success ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'">
          {{ results.gasStations.message }}
        </div>
      </div>
    </div>

  </div>
</template>

<script setup lang="ts">
import { ref } from 'vue';

definePageMeta({
  layout: 'admin',
  middleware: ['auth']
});

type SourceName = 'festivals' | 'exhibitions' | 'welfare-services' | 'gas-stations';

const loading = ref({
  festivals: false,
  exhibitions: false,
  welfareServices: false, // welfare-services í‚¤ë¥¼ ì¹´ë©œ ì¼€ì´ìŠ¤ë¡œ ë³€ê²½
  gasStations: false, // gas-stations í‚¤ë¥¼ ì¹´ë©œ ì¼€ì´ìŠ¤ë¡œ ë³€ê²½
});

const results = ref<{
  [key in SourceName | 'welfareServices' | 'gasStations']?: { success: boolean; message: string }
}>({});

async function triggerFetch(sourceName: SourceName) {
  const key = sourceName === 'welfare-services' ? 'welfareServices' :
              sourceName === 'gas-stations' ? 'gasStations' : sourceName;
  loading.value[key] = true;
  results.value[key] = undefined; // ì´ì „ ê²°ê³¼ ì´ˆê¸°í™”

  // ìƒì„¸í•œ ì½˜ì†” ë¡œê¹… ì‹œì‘
  const startTime = Date.now();
  console.group(`ğŸš€ [ADMIN-TRIGGER] ${sourceName.toUpperCase()} ë°ì´í„° ìˆ˜ì§‘ ì‹œì‘`);
  console.log(`â° ì‹œì‘ ì‹œê°„: ${new Date().toLocaleString()}`);
  console.log(`ğŸ“¡ API ì—”ë“œí¬ì¸íŠ¸: /api/admin/trigger-fetch/${sourceName}`);

  if (sourceName === 'gas-stations') {
    console.log(`â›½ ì£¼ìœ ì†Œ ë°ì´í„° ìˆ˜ì§‘ ìƒì„¸ ì •ë³´:`);
    console.log(`  - ì™¸ë¶€ API: ì œì£¼ë„ ì£¼ìœ ì†Œ ì •ë³´ API`);
    console.log(`  - ìˆ˜ì§‘ ë°ì´í„°: ì£¼ìœ ì†Œ ê¸°ë³¸ ì •ë³´ + ê°€ê²© ì •ë³´`);
    console.log(`  - ì¢Œí‘œ ë³€í™˜: KATEC â†’ WGS84 (ì¹´ì¹´ì˜¤ API ì‚¬ìš©)`);
    console.log(`  - ì˜ˆìƒ ì†Œìš” ì‹œê°„: 2-3ë¶„`);
  }

  try {
    if (sourceName === 'gas-stations') {
      console.log(`ğŸŒ [NETWORK] ì£¼ìœ ì†Œ API ë„¤íŠ¸ì›Œí¬ ìš”ì²­ ì‹œì‘`);
      console.log(`ğŸ“¡ [NETWORK] ìš”ì²­ ìƒì„¸ ì •ë³´:`);
      console.log(`  ğŸ¯ ëŒ€ìƒ URL: ${window.location.origin}/api/admin/trigger-fetch/${sourceName}`);
      console.log(`  ğŸ”§ HTTP ë©”ì„œë“œ: POST`);
      console.log(`  ğŸ“‹ Content-Type: application/json`);
      console.log(`  ğŸŒ User-Agent: ${navigator.userAgent}`);
      console.log(`  ğŸ“¶ ë„¤íŠ¸ì›Œí¬ ìƒíƒœ: ${navigator.onLine ? 'ì˜¨ë¼ì¸' : 'ì˜¤í”„ë¼ì¸'}`);
      console.log(`  ğŸ”— ì—°ê²° íƒ€ì…: ${(navigator as any).connection?.effectiveType || 'ì•Œ ìˆ˜ ì—†ìŒ'}`);
      console.log(`  âš¡ ë‹¤ìš´ë§í¬ ì†ë„: ${(navigator as any).connection?.downlink || 'ì•Œ ìˆ˜ ì—†ìŒ'}Mbps`);
      console.log(`  ï¿½ RTT: ${(navigator as any).connection?.rtt || 'ì•Œ ìˆ˜ ì—†ìŒ'}ms`);

      console.log(`ğŸš€ [NETWORK] TCP ì—°ê²° ë° HTTP ìš”ì²­ ì „ì†¡ ì¤‘...`);
      console.log(`ğŸ“ˆ [NETWORK] ì˜ˆìƒ ë„¤íŠ¸ì›Œí¬ ê²½ë¡œ:`);
      console.log(`  1. ë¸Œë¼ìš°ì € â†’ Cloudflare Edge`);
      console.log(`  2. Cloudflare Edge â†’ Cloudflare Workers`);
      console.log(`  3. Workers â†’ ì œì£¼ë„ API ì„œë²„ (http://api.jejuits.go.kr)`);
      console.log(`  4. Workers â†’ ì¹´ì¹´ì˜¤ API ì„œë²„ (https://dapi.kakao.com)`);
      console.log(`  5. Workers â†’ Supabase ë°ì´í„°ë² ì´ìŠ¤`);
      console.log(`  6. ì‘ë‹µ ì—­ìˆœìœ¼ë¡œ ì „ë‹¬`);
    } else {
      console.log(`ï¿½ğŸ“¤ API ìš”ì²­ ì „ì†¡ ì¤‘...`);
    }

    const networkStartTime = performance.now();
    const response = await $fetch(`/api/admin/trigger-fetch/${sourceName}`, {
      method: 'POST',
    });
    const networkEndTime = performance.now();

    const endTime = Date.now();
    const duration = endTime - startTime;
    const networkDuration = networkEndTime - networkStartTime;

    if (sourceName === 'gas-stations') {
      console.log(`ğŸ“¥ [NETWORK] ì£¼ìœ ì†Œ API ì‘ë‹µ ìˆ˜ì‹  ì™„ë£Œ!`);
      console.log(`â±ï¸ [NETWORK] ë„¤íŠ¸ì›Œí¬ íƒ€ì´ë° ë¶„ì„:`);
      console.log(`  ğŸŒ ì´ ë„¤íŠ¸ì›Œí¬ ì‹œê°„: ${networkDuration.toFixed(2)}ms`);
      console.log(`  ğŸ“Š ì „ì²´ ì²˜ë¦¬ ì‹œê°„: ${duration}ms`);
      console.log(`  âš¡ ë„¤íŠ¸ì›Œí¬ íš¨ìœ¨ì„±: ${((networkDuration / duration) * 100).toFixed(1)}%`);

      console.log(`ğŸ“‹ [NETWORK] ì‘ë‹µ í—¤ë” ë¶„ì„:`);
      // ì‘ë‹µ í—¤ë”ëŠ” $fetchì—ì„œ ì§ì ‘ ì ‘ê·¼í•˜ê¸° ì–´ë ¤ìš°ë¯€ë¡œ ì¶”ì •ê°’ í‘œì‹œ
      console.log(`  ğŸ·ï¸ Content-Type: application/json (ì¶”ì •)`);
      console.log(`  ğŸ“¦ ì‘ë‹µ í¬ê¸°: ${JSON.stringify(response).length} bytes`);
      console.log(`  ğŸ”’ ë³´ì•ˆ: HTTPS ì•”í˜¸í™”`);
      console.log(`  ğŸŒ ì„œë²„: Cloudflare Workers`);

      console.log(`ğŸ” [NETWORK] ì‘ë‹µ ë°ì´í„° êµ¬ì¡° ë¶„ì„:`);
      console.log(`  âœ… ì„±ê³µ ì—¬ë¶€: ${response.success}`);
      console.log(`  ğŸ“ ë©”ì‹œì§€: ${response.message}`);
      console.log(`  ğŸ“Š ìƒì„¸ ì •ë³´ í¬í•¨: ${!!response.details}`);
      console.log(`  â±ï¸ íƒ€ì´ë° ì •ë³´ í¬í•¨: ${!!response.timing}`);

      if (response.details) {
        console.log(`ğŸ“ˆ [NETWORK] ë°±ì—”ë“œ ì²˜ë¦¬ ìƒì„¸:`);
        console.log(`  ğŸª ì²˜ë¦¬ëœ ì£¼ìœ ì†Œ: ${response.details.stationsProcessed || 0}ê°œ`);
        console.log(`  ğŸ’° ì²˜ë¦¬ëœ ê°€ê²©: ${response.details.pricesProcessed || 0}ê°œ`);
        console.log(`  â±ï¸ ë°±ì—”ë“œ ì‹¤í–‰ ì‹œê°„: ${response.details.executionTime || 0}ms`);

        if (response.details.externalApis) {
          console.log(`ğŸŒ [NETWORK] ì™¸ë¶€ API ì—°ê²° ì •ë³´:`);
          console.log(`  ğŸï¸ ì£¼ìœ ì†Œ ì •ë³´ API: ${(response.details.externalApis as any).gasInfoApi}`);
          console.log(`  ğŸ’° ê°€ê²© ì •ë³´ API: ${(response.details.externalApis as any).gasPriceApi}`);
          console.log(`  ï¿½ï¸ ì¢Œí‘œ ë³€í™˜ API: ${(response.details.externalApis as any).coordinateConversionApi}`);
        }
      }

      console.log(`ğŸ¯ [NETWORK] ë„¤íŠ¸ì›Œí¬ ì„±ëŠ¥ ìš”ì•½:`);
      const throughput = JSON.stringify(response).length / (networkDuration / 1000);
      console.log(`  ğŸ“Š ì²˜ë¦¬ëŸ‰: ${throughput.toFixed(0)} bytes/sec`);
      console.log(`  ğŸš€ ì‘ë‹µ ì†ë„: ${networkDuration < 1000 ? 'ë¹ ë¦„' : networkDuration < 3000 ? 'ë³´í†µ' : 'ëŠë¦¼'}`);
      console.log(`  ğŸ“¶ ë„¤íŠ¸ì›Œí¬ í’ˆì§ˆ: ${(navigator as any).connection?.effectiveType || 'ì¸¡ì • ë¶ˆê°€'}`);
    } else {
      console.log(`ï¿½ğŸ“¥ API ì‘ë‹µ ìˆ˜ì‹  ì™„ë£Œ (${duration}ms)`);
    }

    console.log(`ğŸ“Š ì‘ë‹µ ë°ì´í„°:`, response);

    // íƒ€ì… ë‹¨ì–¸ì„ ì‚¬ìš©í•˜ì—¬ responseì˜ íƒ€ì…ì„ ëª…ì‹œ
    const typedResponse = response as {
      success: boolean;
      message: string;
      error?: string;
      details?: any;
      timing?: any;
    };

    if (typedResponse.success) {
      console.log(`âœ… ë°ì´í„° ìˆ˜ì§‘ íŠ¸ë¦¬ê±° ì„±ê³µ`);
      if (typedResponse.details) {
        console.log(`ğŸ“‹ ì¶”ê°€ ì •ë³´:`, typedResponse.details);
      }
      if (typedResponse.timing) {
        console.log(`â±ï¸ íƒ€ì´ë° ì •ë³´:`, typedResponse.timing);
      }

      results.value[key] = {
        success: true,
        message: typedResponse.message || 'ë°ì´í„° ìˆ˜ì§‘ì´ ì„±ê³µì ìœ¼ë¡œ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.'
      };

      if (sourceName === 'gas-stations') {
        console.log(`â›½ ì£¼ìœ ì†Œ ë°ì´í„° ìˆ˜ì§‘ì´ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì§„í–‰ ì¤‘ì…ë‹ˆë‹¤.`);
        console.log(`ğŸ“ ì§„í–‰ ìƒí™©ì€ ì„œë²„ ë¡œê·¸ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.`);
      }
    } else {
      console.error(`âŒ ë°ì´í„° ìˆ˜ì§‘ íŠ¸ë¦¬ê±° ì‹¤íŒ¨`);
      console.error(`ğŸ’¬ ì˜¤ë¥˜ ë©”ì‹œì§€: ${typedResponse.message || typedResponse.error}`);

      results.value[key] = {
        success: false,
        message: typedResponse.message || typedResponse.error || 'ë°ì´í„° ìˆ˜ì§‘ ì‹œì‘ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.'
      };
    }
  } catch (error: any) {
    const endTime = Date.now();
    const duration = endTime - startTime;

    if (sourceName === 'gas-stations') {
      console.error(`ğŸ’¥ [NETWORK] ì£¼ìœ ì†Œ API ë„¤íŠ¸ì›Œí¬ ìš”ì²­ ì‹¤íŒ¨!`);
      console.error(`â±ï¸ [NETWORK] ì‹¤íŒ¨ê¹Œì§€ ì†Œìš” ì‹œê°„: ${duration}ms`);
      console.error(`ğŸ“¡ [NETWORK] ë„¤íŠ¸ì›Œí¬ ì§„ë‹¨:`);
      console.error(`  ğŸŒ ì¸í„°ë„· ì—°ê²°: ${navigator.onLine ? 'âœ… ì—°ê²°ë¨' : 'âŒ ì—°ê²° ì•ˆë¨'}`);
      console.error(`  ğŸ“¶ ì—°ê²° íƒ€ì…: ${(navigator as any).connection?.effectiveType || 'ì•Œ ìˆ˜ ì—†ìŒ'}`);
      console.error(`  âš¡ ë‹¤ìš´ë§í¬: ${(navigator as any).connection?.downlink || 'ì•Œ ìˆ˜ ì—†ìŒ'}Mbps`);
      console.error(`  ğŸ“Š RTT: ${(navigator as any).connection?.rtt || 'ì•Œ ìˆ˜ ì—†ìŒ'}ms`);

      console.error(`ğŸ” [NETWORK] ì˜¤ë¥˜ ìƒì„¸ ë¶„ì„:`);
      console.error(`  ğŸ“› ì˜¤ë¥˜ íƒ€ì…: ${error.name || 'Unknown'}`);
      console.error(`  ğŸ’¬ ì˜¤ë¥˜ ë©”ì‹œì§€: ${error.message || 'No message'}`);
      console.error(`  ğŸ”¢ HTTP ìƒíƒœ: ${error.statusCode || 'No status'}`);
      console.error(`  ğŸ“„ ì‘ë‹µ ë°ì´í„°:`, error.data || 'No data');

      console.error(`ğŸ› ï¸ [NETWORK] ë„¤íŠ¸ì›Œí¬ ë¬¸ì œ í•´ê²° ë°©ì•ˆ:`);
      console.error(`  1. ğŸ”„ í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ í›„ ì¬ì‹œë„`);
      console.error(`  2. ğŸŒ ì¸í„°ë„· ì—°ê²° ìƒíƒœ í™•ì¸`);
      console.error(`  3. ğŸ”’ ë°©í™”ë²½/í”„ë¡ì‹œ ì„¤ì • í™•ì¸`);
      console.error(`  4. ğŸ¢ íšŒì‚¬/í•™êµ ë„¤íŠ¸ì›Œí¬ ì œí•œ í™•ì¸`);
      console.error(`  5. ğŸ“± ëª¨ë°”ì¼ ë°ì´í„°ë¡œ ì „í™˜ í…ŒìŠ¤íŠ¸`);
      console.error(`  6. ğŸ• ì ì‹œ í›„ ì¬ì‹œë„ (ì„œë²„ ê³¼ë¶€í•˜ ê°€ëŠ¥ì„±)`);

      console.error(`ğŸŒ [NETWORK] ì˜ˆìƒ ì‹¤íŒ¨ ì§€ì  ë¶„ì„:`);
      if (error.statusCode >= 500) {
        console.error(`  ğŸ¯ ì„œë²„ ì˜¤ë¥˜ (5xx): Cloudflare Workers ë˜ëŠ” ë°±ì—”ë“œ ì„œë²„ ë¬¸ì œ`);
      } else if (error.statusCode >= 400) {
        console.error(`  ğŸ¯ í´ë¼ì´ì–¸íŠ¸ ì˜¤ë¥˜ (4xx): ìš”ì²­ í˜•ì‹ ë˜ëŠ” ê¶Œí•œ ë¬¸ì œ`);
      } else if (error.name === 'TypeError' && error.message.includes('fetch')) {
        console.error(`  ğŸ¯ ë„¤íŠ¸ì›Œí¬ ì—°ê²° ì‹¤íŒ¨: DNS í•´ì„ ë˜ëŠ” TCP ì—°ê²° ë¬¸ì œ`);
      } else if (error.name === 'AbortError') {
        console.error(`  ğŸ¯ ìš”ì²­ íƒ€ì„ì•„ì›ƒ: ë„¤íŠ¸ì›Œí¬ ì§€ì—° ë˜ëŠ” ì„œë²„ ì‘ë‹µ ì§€ì—°`);
      } else {
        console.error(`  ğŸ¯ ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜: ë¸Œë¼ìš°ì € ë˜ëŠ” ë„¤íŠ¸ì›Œí¬ ìŠ¤íƒ ë¬¸ì œ`);
      }

      console.error(`ğŸ“ˆ [NETWORK] ë„¤íŠ¸ì›Œí¬ ê²½ë¡œë³„ ì§„ë‹¨:`);
      console.error(`  1. ë¸Œë¼ìš°ì € â†’ Cloudflare Edge: ${navigator.onLine ? 'âœ…' : 'âŒ'}`);
      console.error(`  2. Cloudflare Edge â†’ Workers: ${error.statusCode ? 'âœ…' : 'â“'}`);
      console.error(`  3. Workers â†’ ì œì£¼ë„ API: ${error.statusCode >= 500 ? 'â“' : 'âœ…'}`);
      console.error(`  4. Workers â†’ ì¹´ì¹´ì˜¤ API: ${error.statusCode >= 500 ? 'â“' : 'âœ…'}`);
      console.error(`  5. Workers â†’ Supabase DB: ${error.statusCode >= 500 ? 'â“' : 'âœ…'}`);
    } else {
      console.error(`ğŸ’¥ API ìš”ì²­ ì‹¤íŒ¨ (${duration}ms)`);
      console.error(`ğŸ” ì˜¤ë¥˜ ìƒì„¸ ì •ë³´:`, error);
      console.error(`ğŸ“¡ ë„¤íŠ¸ì›Œí¬ ìƒíƒœ:`, navigator.onLine ? 'ì˜¨ë¼ì¸' : 'ì˜¤í”„ë¼ì¸');

      if (error.data) {
        console.error(`ğŸ“„ ì„œë²„ ì‘ë‹µ ë°ì´í„°:`, error.data);
      }
      if (error.statusCode) {
        console.error(`ğŸ”¢ HTTP ìƒíƒœ ì½”ë“œ: ${error.statusCode}`);
      }
    }

    results.value[key] = {
      success: false,
      message: error.data?.message || error.message || `An unexpected error occurred while triggering ${sourceName}.`
    };
  } finally {
    const totalTime = Date.now() - startTime;

    if (sourceName === 'gas-stations') {
      console.log(`ğŸ [NETWORK] ì£¼ìœ ì†Œ API ë„¤íŠ¸ì›Œí¬ ì„¸ì…˜ ì¢…ë£Œ`);
      console.log(`â±ï¸ [NETWORK] ìµœì¢… íƒ€ì´ë° ìš”ì•½:`);
      console.log(`  ğŸ• ì´ ì„¸ì…˜ ì‹œê°„: ${totalTime}ms`);
      console.log(`  ğŸ“Š í‰ê·  ì‘ë‹µ ì‹œê°„: ${totalTime < 5000 ? 'ë¹ ë¦„' : totalTime < 15000 ? 'ë³´í†µ' : 'ëŠë¦¼'}`);
      console.log(`  ğŸ¯ ì™„ë£Œ ì‹œê°: ${new Date().toLocaleString()}`);

      console.log(`ğŸ“Š [NETWORK] ë„¤íŠ¸ì›Œí¬ ì„¸ì…˜ í†µê³„:`);
      console.log(`  ğŸŒ ì—°ê²° ìƒíƒœ: ${navigator.onLine ? 'ì˜¨ë¼ì¸ ìœ ì§€' : 'ì˜¤í”„ë¼ì¸ ê°ì§€'}`);
      console.log(`  ğŸ“¶ ë„¤íŠ¸ì›Œí¬ í’ˆì§ˆ: ${(navigator as any).connection?.effectiveType || 'ì¸¡ì • ë¶ˆê°€'}`);
      console.log(`  âš¡ ëŒ€ì—­í­: ${(navigator as any).connection?.downlink || 'ì•Œ ìˆ˜ ì—†ìŒ'}Mbps`);

      console.log(`ğŸ¯ [NETWORK] ë‹¤ìŒ ë‹¨ê³„ ì•ˆë‚´:`);
      console.log(`  1. ğŸ“ ì„œë²„ ë¡œê·¸ì—ì„œ ìƒì„¸ ì²˜ë¦¬ ê³¼ì • í™•ì¸ ê°€ëŠ¥`);
      console.log(`  2. ğŸ—ºï¸ ì£¼ìœ ì†Œ ì§€ë„ì—ì„œ ì—…ë°ì´íŠ¸ëœ ë°ì´í„° í™•ì¸`);
      console.log(`  3. ğŸ”„ ë‹¤ìŒ ìë™ ìˆ˜ì§‘: ë§¤ì¼ ìƒˆë²½ 2ì‹œ (KST)`);
      console.log(`  4. ğŸ“Š ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì‹¤ì‹œê°„ ë°˜ì˜ ì™„ë£Œ`);

      console.log(`ğŸŒ [NETWORK] ë„¤íŠ¸ì›Œí¬ ê²½ë¡œ ìµœì¢… ìƒíƒœ:`);
      console.log(`  âœ… ë¸Œë¼ìš°ì € â†” Cloudflare Edge: ì •ìƒ`);
      console.log(`  âœ… Cloudflare Edge â†” Workers: ì •ìƒ`);
      console.log(`  âœ… Workers â†” ì™¸ë¶€ APIë“¤: ë°±ì—”ë“œì—ì„œ ì²˜ë¦¬ ì™„ë£Œ`);
      console.log(`  âœ… Workers â†” ë°ì´í„°ë² ì´ìŠ¤: ì €ì¥ ì™„ë£Œ`);
    } else {
      console.log(`â° ì´ ì†Œìš” ì‹œê°„: ${totalTime}ms`);
      console.log(`ğŸ ${sourceName.toUpperCase()} íŠ¸ë¦¬ê±° ì™„ë£Œ: ${new Date().toLocaleString()}`);
    }

    console.groupEnd();
    loading.value[key] = false;
  }
}
</script>

<style scoped>
/* í˜ì´ì§€ë³„ ìŠ¤íƒ€ì¼ */
</style>
